<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ƒê·∫∑t m√≥n th√†nh c√¥ng | Resort Deluxe</title>
  <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="/css/tokens.css">
  <link rel="stylesheet" href="/css/globals.css">
  <link rel="stylesheet" href="/css/grid.css">
  <link rel="stylesheet" href="css/navbar-auth.css">
  <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
  <link rel="stylesheet" href="/css/components/navbar.css">
  <style>
    body{font-family:'Poppins',sans-serif;padding-top:0;overflow-x:hidden;background:#f8f9fa;font-size:16px;line-height:1.6;color:#1a1a1a}
    h1,h2,h3,h4,h5,h6{font-family:'Poppins',sans-serif;font-weight:700;color:#1a1a1a}
    p,span,div,label{font-family:'Poppins',sans-serif}
    .order-details-card *{font-family:'Poppins',sans-serif}
    .detail-label{font-family:'Poppins',sans-serif;font-size:15px;font-weight:500}
    .detail-value{font-family:'Poppins',sans-serif;font-size:16px;font-weight:600}
    .ftco-navbar{position:sticky!important;top:0!important;z-index:1030!important;background-color:#1a1a1a!important;transition:all 0.3s ease;width:100%!important;margin:0!important}
    
    /* Modern Hero Section */
    .success-hero {
      background-image: url('images/menu-2.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
      padding: 140px 0 100px;
      color: #fff;
      text-align: center;
      position: relative;
      overflow: hidden;
      margin-bottom: 60px;
      min-height: 500px;
      display: flex;
      align-items: center;
    }
    .success-hero::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(135deg, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.5) 100%);
      z-index: 0;
    }
    .success-hero::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse"><path d="M 50 0 L 0 0 0 50" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      opacity: 0.3;
      z-index: 1;
    }
    .success-hero .container {
      position: relative;
      z-index: 2;
    }
    .success-hero h1 {
      font-size: 48px;
      font-weight: 700;
      margin-bottom: 20px;
      color: #ffffff !important;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
      animation: fadeInDown 1s ease;
    }
    .success-hero p {
      font-size: 20px;
      color: #ffffff !important;
      opacity: 0.95;
      text-shadow: 0 2px 8px rgba(0,0,0,0.2);
      animation: fadeInUp 1.2s ease;
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .success-icon{
      width:140px;
      height:140px;
      background:#fff;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      margin:0 auto 35px;
      font-size:70px;
      animation:successPulse 2s infinite;
      box-shadow:0 15px 50px rgba(0,0,0,0.25);
      position:relative;
      z-index:1
    }
    .success-icon::after{
      content:'';
      position:absolute;
      width:100%;
      height:100%;
      border-radius:50%;
      border:3px solid rgba(200,169,126,0.3);
      animation:ripple 2s infinite
    }
    
    .order-details-card{
      background:#fff;
      padding:50px;
      border-radius:24px;
      box-shadow:0 20px 60px rgba(0,0,0,0.12);
      margin-top:-70px;
      position:relative;
      z-index:10;
      animation:slideUp 0.8s ease;
      max-width:900px;
      margin-left:auto;
      margin-right:auto
    }
    .detail-row{
      display:flex;
      align-items:center;
      padding:20px 0;
      border-bottom:2px solid #f0f0f0;
      gap:20px
    }
    .detail-row:last-child{border-bottom:none}
    .detail-icon{
      width:50px;
      height:50px;
      background:linear-gradient(135deg,#c8a97e 0%,#b89968 100%);
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:24px;
      flex-shrink:0;
      box-shadow:0 4px 12px rgba(200,169,126,0.25)
    }
    .detail-content{
      flex:1;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:20px
    }
    .detail-label{
      color:#666;
      font-weight:500;
      font-size:15px
    }
    .detail-value{
      color:#1a1a1a;
      font-weight:700;
      font-size:16px;
      text-align:right
    }
    .detail-value.badge{
      padding:8px 16px;
      font-size:14px;
      font-weight:600;
      border-radius:8px
    }
    .detail-value.amount{
      color:#c8a97e;
      font-size:20px;
      font-weight:700
    }
    
    .action-buttons{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      gap:15px;
      margin-top:40px;
      padding-top:30px;
      border-top:2px solid #f0f0f0
    }
    .btn-action{
      padding:16px 28px;
      border-radius:12px;
      font-weight:600;
      font-size:16px;
      transition:all 0.3s;
      text-decoration:none;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      border:2px solid transparent
    }
    .btn-action:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 20px rgba(0,0,0,0.15)
    }
    .btn-primary-action{
      background:linear-gradient(135deg,#c8a97e 0%,#b89968 100%);
      color:#fff;
      border:none
    }
    .btn-primary-action:hover{
      background:linear-gradient(135deg,#b89968 0%,#c8a97e 100%);
      color:#fff
    }
    .btn-outline-action{
      background:#fff;
      color:#c8a97e;
      border-color:#c8a97e
    }
    .btn-outline-action:hover{
      background:#c8a97e;
      color:#fff;
      border-color:#c8a97e
    }
    
    .order-items-box{
      background:#f8f9fa;
      border-radius:12px;
      padding:20px;
      margin-top:10px;
      border-left:4px solid #c8a97e
    }
    .order-item{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:12px 0;
      border-bottom:1px solid #e9ecef
    }
    .order-item:last-child{border-bottom:none}
    .order-item-name{
      font-weight:600;
      color:#1a1a1a;
      font-size:15px
    }
    .order-item-qty{
      color:#666;
      font-size:14px;
      margin-left:10px
    }
    .order-item-price{
      color:#c8a97e;
      font-weight:700;
      font-size:16px
    }
    
    @keyframes successPulse{
      0%,100%{transform:scale(1);box-shadow:0 15px 50px rgba(0,0,0,0.25)}
      50%{transform:scale(1.05);box-shadow:0 20px 60px rgba(0,0,0,0.35)}
    }
    @keyframes ripple{
      0%{transform:scale(1);opacity:1}
      100%{transform:scale(1.3);opacity:0}
    }
    @keyframes slideUp{
      from{opacity:0;transform:translateY(50px)}
      to{opacity:1;transform:translateY(0)}
    }
    
    @media(max-width:768px){
      .order-details-card{padding:30px 20px;margin-top:-50px}
      .detail-row{flex-direction:column;align-items:flex-start;gap:15px}
      .detail-content{flex-direction:column;align-items:flex-start;width:100%}
      .detail-value{text-align:left;width:100%}
      .action-buttons{grid-template-columns:1fr}
      .success-hero{
        padding: 100px 0 60px;
        min-height: 400px;
      }
      .success-hero h1 {
        font-size: 32px;
      }
      .success-hero p {
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <!-- Header placeholder - will be loaded by load-header.js -->
  <div id="header-placeholder"></div>
  
  <!-- Load header component -->
  <script src="js/load-header.js"></script>

  <div class="success-hero">
    <div class="container">
      <h1 class="display-4 mb-3" style="font-weight:700;font-size:48px;text-shadow:0 2px 10px rgba(0,0,0,0.2)">ƒê·∫∑t m√≥n th√†nh c√¥ng!</h1>
      <p class="lead" style="font-size:20px;font-weight:400;opacity:0.95">C·∫£m ∆°n b·∫°n ƒë√£ ch·ªçn RESORT DELUXE. Ch√∫ng t√¥i ƒë√£ ghi nh·∫≠n ƒë∆°n ƒë·∫∑t m√≥n c·ªßa b·∫°n.</p>
    </div>
  </div>

  <div class="container mb-5">
    <div class="order-details-card">
      <h3 class="mb-4 text-center" style="font-size:28px;font-weight:700;color:#1a1a1a;margin-bottom:35px">
        üìã Th√¥ng tin ƒë∆°n h√†ng
      </h3>
      <div id="orderDetails">
        <div class="text-center py-5">
          <div class="spinner-border text-primary" role="status" style="width:3rem;height:3rem;border-width:4px">
            <span class="sr-only">Loading...</span>
          </div>
          <p class="mt-4 text-muted" style="font-size:16px">ƒêang t·∫£i th√¥ng tin...</p>
        </div>
      </div>
      
      <div class="action-buttons">
        <a href="my-restaurant-orders.html" class="btn btn-primary-action">
          <span class="oi oi-list"></span> Xem ƒë∆°n h√†ng c·ªßa t√¥i
        </a>
        <a href="index.html" class="btn btn-outline-action">
          <span class="oi oi-home"></span> V·ªÅ trang ch·ªß
        </a>
      </div>
    </div>
  </div>

      <footer class="ftco-footer ftco-bg-dark ftco-section">
      <div class="container">
        <div class="row mb-5">
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">RESORT DELUXE</h2>
              <p>Khu ngh·ªâ d∆∞·ª°ng cao c·∫•p v·ªõi kh√¥ng gian sang tr·ªçng, d·ªãch v·ª• chu ƒë√°o v√† ti·ªán nghi hi·ªán ƒë·∫°i, mang ƒë·∫øn cho b·∫°n k·ª≥ ngh·ªâ tr·ªçn v·∫πn.</p>
              <ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
                <li class="ftco-animate"><a href="#" style="display: block !important; visibility: visible !important; opacity: 1 !important;"><span class="icon-twitter"></span></a></li>
                <li class="ftco-animate"><a href="#" style="display: block !important; visibility: visible !important; opacity: 1 !important;"><span class="icon-facebook"></span></a></li>
                <li class="ftco-animate"><a href="#" style="display: block !important; visibility: visible !important; opacity: 1 !important;"><span class="icon-instagram"></span></a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4 ml-md-5">
              <h2 class="ftco-heading-2">Li√™n k·∫øt h·ªØu √≠ch</h2>
              <ul class="list-unstyled">
                <li><a href="#" class="py-2 d-block">Blog</a></li>
                <li><a href="#" class="py-2 d-block">Ph√≤ng</a></li>
                <li><a href="#" class="py-2 d-block">Ti·ªán √≠ch</a></li>
                <li><a href="#" class="py-2 d-block">Th·∫ª qu√† t·∫∑ng</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
             <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">Ch√≠nh s√°ch</h2>
              <ul class="list-unstyled">
                <li><a href="#" class="py-2 d-block">Tuy·ªÉn d·ª•ng</a></li>
                <li><a href="#" class="py-2 d-block">V·ªÅ ch√∫ng t√¥i</a></li>
                <li><a href="#" class="py-2 d-block">Li√™n h·ªá</a></li>
                <li><a href="#" class="py-2 d-block">D·ªãch v·ª•</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
                <h2 class="ftco-heading-2">B·∫°n c·∫ßn h·ªó tr·ª£?</h2>
            	<div class="block-23 mb-3">
	              <ul>
                <li><span class="icon icon-map-marker"></span><span class="text">123 ƒê∆∞·ªùng Bi·ªÉn Xanh, Th√†nh ph·ªë Bi·ªÉn, Vi·ªát Nam</span></li>
                <li><a href="#"><span class="icon icon-phone"></span><span class="text">+84 901 329 227</span></a></li>
                <li><a href="#"><span class="icon icon-envelope"></span><span class="text">support@resortdeluxe.vn</span></a></li>
	              </ul>
	            </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 text-center">
            <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
  Copyright ¬©<script>document.write(new Date().getFullYear());</script>2025 All rights reserved | This template is made with <i class="icon-heart color-danger" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
  <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
          </div>
        </div>
      </div>
    </footer>

  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="../js/api.js"></script>
  <script src="js/navbar-auth.js"></script>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const orderId = urlParams.get('orderId');
    
    function formatCurrency(amount) {
      try {
        return new Intl.NumberFormat('vi-VN', {
          style: 'currency',
          currency: 'VND',
          minimumFractionDigits: 0,
          maximumFractionDigits: 0
        }).format(amount || 0);
      } catch(_) {
        return (amount || 0).toLocaleString('vi-VN') + ' ‚Ç´';
      }
    }

    async function loadOrderDetails() {
      if (!orderId) {
        document.getElementById('orderDetails').innerHTML = `
          <div class="alert alert-warning" style="padding:25px;border-radius:12px;border-left:4px solid #ffc107">
            <h5 style="font-weight:700;margin-bottom:15px">‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y m√£ ƒë∆°n h√†ng</h5>
            <p style="margin:0;font-size:15px">Vui l√≤ng ki·ªÉm tra l·∫°i email ho·∫∑c li√™n h·ªá v·ªõi ch√∫ng t√¥i qua s·ªë ƒëi·ªán tho·∫°i: <strong>+84 901 329 227</strong></p>
          </div>
        `;
        return;
      }

      try {
        const token = localStorage.getItem('token');
        if (!token) {
          document.getElementById('orderDetails').innerHTML = `
            <div class="alert alert-info" style="padding:25px;border-radius:12px;border-left:4px solid #0dcaf0">
              <h5 style="font-weight:700;margin-bottom:15px">üîê Vui l√≤ng ƒëƒÉng nh·∫≠p</h5>
              <p style="margin:0;font-size:15px">ƒê·ªÉ xem chi ti·∫øt ƒë∆°n h√†ng, vui l√≤ng <a href="login.html" style="font-weight:600;color:#0dcaf0">ƒëƒÉng nh·∫≠p</a>.</p>
            </div>
          `;
          return;
        }

        const API_ORDER = `${location.origin}/api/restaurant-orders/${orderId}?_=${Date.now()}`;
        const resp = await fetch(API_ORDER, {
          headers: {
            'Authorization': `Bearer ${token}`
          },
          cache: 'no-store'
        });

        if (!resp.ok) {
          throw new Error('Kh√¥ng th·ªÉ t·∫£i th√¥ng tin ƒë∆°n h√†ng');
        }

        const order = await resp.json();
        renderOrderDetails(order);
      } catch(e) {
        console.error('Error loading order:', e);
        document.getElementById('orderDetails').innerHTML = `
          <div class="alert alert-success" style="padding:25px;border-radius:12px;border-left:4px solid #198754">
            <h5 style="font-weight:700;margin-bottom:15px">‚úÖ ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n</h5>
            <p style="margin-bottom:10px"><strong>M√£ ƒë∆°n h√†ng:</strong> <span style="color:#198754;font-size:18px">${orderId}</span></p>
            <p style="margin:0;font-size:15px">Ch√∫ng t√¥i s·∫Ω li√™n h·ªá v·ªõi b·∫°n trong th·ªùi gian s·ªõm nh·∫•t ƒë·ªÉ x√°c nh·∫≠n. Vui l√≤ng ki·ªÉm tra email ho·∫∑c ƒëi·ªán tho·∫°i c·ªßa b·∫°n.</p>
          </div>
        `;
      }
    }

    async function renderOrderDetails(order) {
      const orderDate = new Date(order.createdAt || order.orderDate).toLocaleDateString('vi-VN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' });
      const orderNumber = order.orderNumber || `ORD${orderId}`;
      const deliveryTime = order.deliveryTime ? new Date(order.deliveryTime).toLocaleString('vi-VN') : '-';
      const deliveryAddress = order.deliveryAddress || '-';
      
      // Build order items HTML
      let orderItemsHtml = '';
      if (order.orderItems && order.orderItems.length > 0) {
        orderItemsHtml = order.orderItems.map(item => {
          const itemName = item.service?.serviceName || item.serviceName || 'N/A';
          const quantity = item.quantity || 0;
          const unitPrice = item.unitPrice || item.price || 0;
          const subtotal = quantity * unitPrice;
          return `
            <div class="order-item">
              <div>
                <span class="order-item-name">${itemName}</span>
                <span class="order-item-qty">x${quantity}</span>
              </div>
              <span class="order-item-price">${formatCurrency(subtotal)}</span>
            </div>
          `;
        }).join('');
      } else {
        orderItemsHtml = '<p style="color:#666;margin:0">Kh√¥ng c√≥ m√≥n n√†o trong ƒë∆°n h√†ng</p>';
      }
      
      document.getElementById('orderDetails').innerHTML = `
        <div class="detail-row">
          <div class="detail-icon">üé´</div>
          <div class="detail-content">
            <span class="detail-label">M√£ ƒë∆°n h√†ng</span>
            <span class="detail-value">${orderNumber}</span>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-icon">üìä</div>
          <div class="detail-content">
            <span class="detail-label">Tr·∫°ng th√°i</span>
            <span class="detail-value"><span class="badge bg-${getStatusColor(order.status)}">${getStatusText(order.status)}</span></span>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-icon">üí≥</div>
          <div class="detail-content">
            <span class="detail-label">Thanh to√°n</span>
            <span class="detail-value"><span class="badge bg-${getPaymentStatusColor(order.paymentStatus)}">${getPaymentStatusText(order.paymentStatus)}</span></span>
          </div>
        </div>
        <div class="detail-row">
          <div class="detail-icon">üìÖ</div>
          <div class="detail-content">
            <span class="detail-label">Ng√†y ƒë·∫∑t</span>
            <span class="detail-value">${orderDate}</span>
          </div>
        </div>
        ${deliveryTime !== '-' ? `
        <div class="detail-row">
          <div class="detail-icon">‚è∞</div>
          <div class="detail-content">
            <span class="detail-label">Th·ªùi gian giao</span>
            <span class="detail-value">${deliveryTime}</span>
          </div>
        </div>
        ` : ''}
        ${deliveryAddress !== '-' ? `
        <div class="detail-row">
          <div class="detail-icon">üìç</div>
          <div class="detail-content">
            <span class="detail-label">ƒê·ªãa ch·ªâ giao h√†ng</span>
            <span class="detail-value" style="text-align:right;max-width:60%">${deliveryAddress}</span>
          </div>
        </div>
        ` : ''}
        <div class="detail-row">
          <div class="detail-icon">üí∞</div>
          <div class="detail-content">
            <span class="detail-label">T·ªïng ti·ªÅn</span>
            <span class="detail-value amount">${formatCurrency(order.totalAmount || 0)}</span>
          </div>
        </div>
        <div class="detail-row" style="flex-direction:column;align-items:flex-start">
          <div style="display:flex;align-items:center;gap:15px;margin-bottom:15px;width:100%">
            <div class="detail-icon">üçΩÔ∏è</div>
            <span class="detail-label">Danh s√°ch m√≥n ƒÉn</span>
          </div>
          <div class="order-items-box" style="width:100%;margin-left:70px">
            ${orderItemsHtml}
          </div>
        </div>
      `;
      
      // Update action buttons to include order details link if orderId exists
      const actionButtons = document.querySelector('.action-buttons');
      if (orderId && actionButtons) {
        actionButtons.innerHTML = `
          <a href="order-details.html?orderId=${orderId}" class="btn btn-primary-action">
            <span class="oi oi-eye"></span> Xem chi ti·∫øt
          </a>
          <a href="my-restaurant-orders.html" class="btn btn-outline-action">
            <span class="oi oi-list"></span> ƒê∆°n h√†ng c·ªßa t√¥i
          </a>
          <a href="index.html" class="btn btn-outline-action">
            <span class="oi oi-home"></span> V·ªÅ trang ch·ªß
          </a>
        `;
      }
    }

    function getStatusColor(status) {
      const colors = {
        'Pending': 'warning',
        'Confirmed': 'info',
        'Preparing': 'primary',
        'Ready': 'success',
        'Delivered': 'success',
        'Cancelled': 'danger'
      };
      return colors[status] || 'secondary';
    }

    function getStatusText(status) {
      const texts = {
        'Pending': 'Ch·ªù x√°c nh·∫≠n',
        'Confirmed': 'ƒê√£ x√°c nh·∫≠n',
        'Preparing': 'ƒêang chu·∫©n b·ªã',
        'Ready': 'S·∫µn s√†ng',
        'Delivered': 'ƒê√£ giao',
        'Cancelled': 'ƒê√£ h·ªßy'
      };
      return texts[status] || status;
    }

    function getPaymentStatusColor(paymentStatus) {
      const colors = {
        'Unpaid': 'warning',
        'Paid': 'success',
        'Refunded': 'danger'
      };
      return colors[paymentStatus] || 'secondary';
    }

    function getPaymentStatusText(paymentStatus) {
      const texts = {
        'Unpaid': 'Ch∆∞a thanh to√°n',
        'Paid': 'ƒê√£ thanh to√°n',
        'Refunded': 'ƒê√£ ho√†n ti·ªÅn'
      };
      return texts[paymentStatus] || paymentStatus;
    }

    // Load on page load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadOrderDetails);
    } else {
      loadOrderDetails();
    }

    // Also load on pageshow (back/forward navigation)
    window.addEventListener('pageshow', function(event) {
      if (event.persisted || (performance.navigation && performance.navigation.type === 2)) {
        loadOrderDetails();
      }
    });
  </script>
  
  <!-- AI Chat Widget -->
  <script src="js/ai-chat.js"></script>
</body>
</html>

