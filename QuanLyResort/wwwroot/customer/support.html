<!DOCTYPE html>
<html lang="vi">
  <head>
    <title>H·ªó tr·ª£ kh√°ch h√†ng | Resort Deluxe</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700" rel="stylesheet">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="/css/tokens.css">
    <link rel="stylesheet" href="/css/globals.css">
    <link rel="stylesheet" href="/css/grid.css">
    <link rel="stylesheet" href="/css/components/navbar.css">
    <link rel="stylesheet" href="css/navbar-auth.css">
    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
  
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        padding-top: 0;
        overflow-x: hidden;
        background: #f8f9fa;
      }
      
      .ftco-navbar {
        position: sticky !important;
        top: 0 !important;
        z-index: 1030 !important;
        background-color: #1a1a1a !important;
        transition: all 0.3s ease;
        width: 100% !important;
        margin: 0 !important;
      }
      
      .rooms-hero {
        background-image: url('images/bg_1.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        padding: 140px 0 100px;
        color: #fff;
        text-align: center;
        position: relative;
        overflow: hidden;
        margin-bottom: 60px;
        min-height: 500px;
        display: flex;
        align-items: center;
      }
      
      .rooms-hero::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(135deg, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.5) 100%);
        z-index: 0;
      }
      
      .rooms-hero-content {
        position: relative;
        z-index: 2;
        width: 100%;
      }
      
      .rooms-hero h1 {
        font-size: 48px;
        font-weight: 700;
        margin-bottom: 20px;
        color: #ffffff !important;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
      }
      
      .support-section {
        padding: 60px 0;
      }
      
      .support-card {
        background: white;
        border-radius: 16px;
        padding: 40px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        margin-bottom: 30px;
      }
      
      .support-form .form-group {
        margin-bottom: 25px;
      }
      
      .support-form label {
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
        display: block;
      }
      
      .support-form .form-control,
      .support-form .form-select {
        padding: 12px 15px;
        border-radius: 10px;
        border: 2px solid #e5e7eb;
        font-size: 15px;
        transition: all 0.3s ease;
      }
      
      .support-form .form-control:focus,
      .support-form .form-select:focus {
        outline: none;
        border-color: #c8a97e;
        box-shadow: 0 0 0 3px rgba(200,169,126,0.1);
      }
      
      .support-form textarea {
        min-height: 150px;
        resize: vertical;
      }
      
      .btn-submit-ticket {
        background: linear-gradient(135deg, #c8a97e 0%, #b89968 100%);
        color: white;
        padding: 14px 30px;
        border-radius: 10px;
        font-weight: 600;
        font-size: 16px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
      }
      
      .btn-submit-ticket:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(200,169,126,0.3);
      }
      
      .btn-submit-ticket:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }
      
      .info-box {
        background: linear-gradient(135deg, rgba(200,169,126,0.1) 0%, rgba(184,153,104,0.1) 100%);
        border-left: 4px solid #c8a97e;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
      }
      
      .info-box h5 {
        color: #c8a97e;
        font-weight: 600;
        margin-bottom: 10px;
      }
      
      .quick-links {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 20px;
      }
      
      .quick-link-btn {
        padding: 12px 20px;
        background: white;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        text-decoration: none;
        color: #374151;
        font-weight: 500;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      
      .quick-link-btn:hover {
        border-color: #c8a97e;
        color: #c8a97e;
        transform: translateY(-2px);
      }
      
      .success-message {
        background: #d1fae5;
        border: 2px solid #10b981;
        color: #065f46;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 30px;
        display: none;
      }
      
      .success-message.show {
        display: block;
        animation: slideDown 0.3s ease;
      }
      
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      @media (max-width: 768px) {
        .rooms-hero h1 {
          font-size: 36px;
        }
        .support-card {
          padding: 25px;
        }
      }
    </style>
  </head>
  <body>

    <!-- Header placeholder -->
    <div id="header-placeholder"></div>
    <script src="js/load-header.js"></script>

    <section class="rooms-hero">
      <div class="container">
        <div class="rooms-hero-content">
          <h1>H·ªó tr·ª£ kh√°ch h√†ng</h1>
          <p>Ch√∫ng t√¥i lu√¥n s·∫µn s√†ng h·ªó tr·ª£ b·∫°n</p>
        </div>
      </div>
    </section>

    <section class="support-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-8">
            <div class="support-card">
              <h3 class="mb-4" style="color: #1a1a1a; font-weight: 700;">G·ª≠i y√™u c·∫ßu h·ªó tr·ª£</h3>
              
              <div class="success-message" id="successMessage">
                <h5 style="color: #065f46; margin-bottom: 10px;">‚úÖ Y√™u c·∫ßu ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng!</h5>
                <p style="margin: 0;">M√£ ticket c·ªßa b·∫°n: <strong id="ticketNumber"></strong></p>
                <p style="margin: 10px 0 0 0;">Ch√∫ng t√¥i s·∫Ω ph·∫£n h·ªìi trong th·ªùi gian s·ªõm nh·∫•t. B·∫°n c√≥ th·ªÉ theo d√µi tr·∫°ng th√°i ticket trong <a href="my-tickets.html" style="color: #10b981; font-weight: 600;">Trang tickets c·ªßa t√¥i</a>.</p>
              </div>
              
              <form class="support-form" id="supportForm">
                <div class="form-group">
                  <label for="subject">Ti√™u ƒë·ªÅ *</label>
                  <input type="text" class="form-control" id="subject" name="subject" required placeholder="VD: V·∫•n ƒë·ªÅ v·ªÅ ƒë·∫∑t ph√≤ng">
                </div>
                
                <div class="form-group">
                  <label for="category">Danh m·ª•c *</label>
                  <select class="form-select" id="category" name="category" required>
                    <option value="">Ch·ªçn danh m·ª•c</option>
                    <option value="General">T·ªïng qu√°t</option>
                    <option value="Booking">ƒê·∫∑t ph√≤ng</option>
                    <option value="Payment">Thanh to√°n</option>
                    <option value="Restaurant">Nh√† h√†ng</option>
                    <option value="Services">D·ªãch v·ª•</option>
                    <option value="Complaint">Khi·∫øu n·∫°i</option>
                    <option value="Other">Kh√°c</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label for="priority">M·ª©c ƒë·ªô ∆∞u ti√™n</label>
                  <select class="form-select" id="priority" name="priority">
                    <option value="Normal">B√¨nh th∆∞·ªùng</option>
                    <option value="High">Cao</option>
                    <option value="Urgent">Kh·∫©n c·∫•p</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label for="description">M√¥ t·∫£ chi ti·∫øt *</label>
                  <textarea class="form-control" id="description" name="description" required placeholder="Vui l√≤ng m√¥ t·∫£ chi ti·∫øt v·∫•n ƒë·ªÅ c·ªßa b·∫°n..."></textarea>
                </div>
                
                <div id="contactInfoSection">
                  <h5 class="mb-3" style="color: #374151; font-weight: 600;">Th√¥ng tin li√™n h·ªá</h5>
                  
                  <div class="form-group">
                    <label for="contactName">H·ªç v√† t√™n</label>
                    <input type="text" class="form-control" id="contactName" name="contactName" placeholder="Nh·∫≠p h·ªç t√™n c·ªßa b·∫°n">
                  </div>
                  
                  <div class="form-group">
                    <label for="contactEmail">Email *</label>
                    <input type="email" class="form-control" id="contactEmail" name="contactEmail" required placeholder="email@example.com">
                  </div>
                  
                  <div class="form-group">
                    <label for="contactPhone">S·ªë ƒëi·ªán tho·∫°i</label>
                    <input type="tel" class="form-control" id="contactPhone" name="contactPhone" placeholder="+84 901 329 227">
                  </div>
                </div>
                
                <button type="submit" class="btn-submit-ticket" id="submitBtn">
                  <span class="spinner-border spinner-border-sm d-none" id="submitSpinner" role="status"></span>
                  <span id="submitText">G·ª≠i y√™u c·∫ßu h·ªó tr·ª£</span>
                </button>
              </form>
            </div>
          </div>
          
          <div class="col-lg-4">
            <div class="support-card">
              <h5 style="color: #1a1a1a; font-weight: 700; margin-bottom: 20px;">Th√¥ng tin li√™n h·ªá</h5>
              
              <div class="mb-4">
                <div style="display: flex; align-items: center; margin-bottom: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #c8a97e 0%, #b89968 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 24px; color: #fff;">üìû</span>
                  </div>
                  <div>
                    <strong style="color: #1a1a1a; font-size: 16px;">Hotline</strong>
                    <p style="color: #6b7280; margin: 0; font-size: 15px;">+84 901 329 227</p>
                  </div>
                </div>
                
                <div style="display: flex; align-items: center; margin-bottom: 15px;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #c8a97e 0%, #b89968 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 24px; color: #fff;">üìß</span>
                  </div>
                  <div>
                    <strong style="color: #1a1a1a; font-size: 16px;">Email</strong>
                    <p style="color: #6b7280; margin: 0; font-size: 15px;">support@resortdeluxe.vn</p>
                  </div>
                </div>
                
                <div style="display: flex; align-items: center;">
                  <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #c8a97e 0%, #b89968 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 24px; color: #fff;">üìç</span>
                  </div>
                  <div>
                    <strong style="color: #1a1a1a; font-size: 16px;">ƒê·ªãa ch·ªâ</strong>
                    <p style="color: #6b7280; margin: 0; font-size: 15px;">123 ƒê∆∞·ªùng Bi·ªÉn Xanh, Th√†nh ph·ªë Bi·ªÉn, Vi·ªát Nam</p>
                  </div>
                </div>
              </div>
              
              <div class="info-box">
                <h5>üí° M·∫πo</h5>
                <p style="margin: 0; color: #6b7280; font-size: 14px; line-height: 1.6;">
                  Tr∆∞·ªõc khi g·ª≠i y√™u c·∫ßu, b·∫°n c√≥ th·ªÉ t√¨m c√¢u tr·∫£ l·ªùi trong <a href="faq.html" style="color: #c8a97e; font-weight: 600;">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a>.
                </p>
              </div>
              
              <div class="quick-links">
                <a href="faq.html" class="quick-link-btn">
                  <span class="icon-help-circle"></span> FAQ
                </a>
                <a href="my-tickets.html" class="quick-link-btn" id="myTicketsLink" style="display: none;">
                  <span class="icon-list"></span> Tickets c·ªßa t√¥i
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer class="ftco-footer ftco-bg-dark ftco-section">
      <div class="container">
        <div class="row mb-5">
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">RESORT DELUXE</h2>
              <p>Khu ngh·ªâ d∆∞·ª°ng cao c·∫•p v·ªõi kh√¥ng gian sang tr·ªçng, d·ªãch v·ª• chu ƒë√°o v√† ti·ªán nghi hi·ªán ƒë·∫°i, mang ƒë·∫øn cho b·∫°n k·ª≥ ngh·ªâ tr·ªçn v·∫πn.</p>
              <ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
                <li class="ftco-animate"><a href="https://twitter.com/resortdeluxe" target="_blank" rel="noopener noreferrer"><span class="icon-twitter"></span></a></li>
                <li class="ftco-animate"><a href="https://www.facebook.com/resortdeluxe" target="_blank" rel="noopener noreferrer"><span class="icon-facebook"></span></a></li>
                <li class="ftco-animate"><a href="https://www.youtube.com/@resortdeluxe" target="_blank" rel="noopener noreferrer"><span class="icon-google-plus"></span></a></li>
                <li class="ftco-animate"><a href="https://www.instagram.com/resortdeluxe" target="_blank" rel="noopener noreferrer"><span class="icon-instagram"></span></a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4 ml-md-5">
              <h2 class="ftco-heading-2">Li√™n k·∫øt h·ªØu √≠ch</h2>
              <ul class="list-unstyled">
                <li><a href="blog.html" class="py-2 d-block">Blog</a></li>
                <li><a href="rooms.html" class="py-2 d-block">Ph√≤ng ngh·ªâ</a></li>
                <li><a href="restaurant.html" class="py-2 d-block">Nh√† h√†ng & D·ªãch v·ª•</a></li>
                <li><a href="about.html" class="py-2 d-block">V·ªÅ ch√∫ng t√¥i</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
             <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">Ch√≠nh s√°ch</h2>
              <ul class="list-unstyled">
                <li><a href="contact.html" class="py-2 d-block">Li√™n h·ªá</a></li>
                <li><a href="faq.html" class="py-2 d-block">C√¢u h·ªèi th∆∞·ªùng g·∫∑p</a></li>
                <li><a href="support.html" class="py-2 d-block">H·ªó tr·ª£</a></li>
                <li><a href="about.html" class="py-2 d-block">Tuy·ªÉn d·ª•ng</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">B·∫°n c·∫ßn h·ªó tr·ª£?</h2>
              <div class="block-23 mb-3">
                <ul>
                  <li><span class="icon icon-map-marker"></span><span class="text">123 ƒê∆∞·ªùng Bi·ªÉn Xanh, Th√†nh ph·ªë Bi·ªÉn, Vi·ªát Nam</span></li>
                  <li><a href="tel:+84901329227"><span class="icon icon-phone"></span><span class="text">+84 901 329 227</span></a></li>
                  <li><a href="mailto:support@resortdeluxe.vn"><span class="icon icon-envelope"></span><span class="text">support@resortdeluxe.vn</span></a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 text-center">
            <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart color-danger" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
          </div>
        </div>
      </div>
    </footer>

    <script src="js/jquery.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/navbar-auth.js"></script>
    <script src="../js/api.js"></script>

    <script>
      // Check if user is logged in
      const token = localStorage.getItem('token');
      const userStr = localStorage.getItem('user');
      
      if (token && userStr) {
        try {
          const user = JSON.parse(userStr);
          // Pre-fill contact info if logged in
          if (user.email) {
            document.getElementById('contactEmail').value = user.email;
          }
          if (user.fullName) {
            document.getElementById('contactName').value = user.fullName;
          }
          // Show "My Tickets" link
          document.getElementById('myTicketsLink').style.display = 'inline-flex';
        } catch (e) {
          console.error('[Support] Error parsing user:', e);
        }
      }

      // Handle form submission
      document.getElementById('supportForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const submitBtn = document.getElementById('submitBtn');
        const submitSpinner = document.getElementById('submitSpinner');
        const submitText = document.getElementById('submitText');
        
        // Disable button and show spinner
        submitBtn.disabled = true;
        submitSpinner.classList.remove('d-none');
        submitText.textContent = 'ƒêang g·ª≠i...';
        
        try {
          const formData = {
            subject: document.getElementById('subject').value.trim(),
            description: document.getElementById('description').value.trim(),
            category: document.getElementById('category').value,
            priority: document.getElementById('priority').value,
            contactName: document.getElementById('contactName').value.trim(),
            contactEmail: document.getElementById('contactEmail').value.trim(),
            contactPhone: document.getElementById('contactPhone').value.trim()
          };
          
          const response = await fetch(`${location.origin}/api/supporttickets`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token || ''}`
            },
            body: JSON.stringify(formData)
          });
          
          if (!response.ok) {
            const error = await response.json();
            throw new Error(error.message || 'Kh√¥ng th·ªÉ g·ª≠i y√™u c·∫ßu');
          }
          
          const result = await response.json();
          
          // Show success message
          document.getElementById('ticketNumber').textContent = result.ticket.ticketNumber;
          document.getElementById('successMessage').classList.add('show');
          
          // Scroll to success message
          document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          
          // Reset form
          document.getElementById('supportForm').reset();
          
          if (typeof showToast === 'function') {
            showToast(`Y√™u c·∫ßu ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng! M√£ ticket: ${result.ticket.ticketNumber}`, 'success');
          }
          
        } catch (error) {
          console.error('[Support] Error submitting ticket:', error);
          if (typeof showToast === 'function') {
            showToast('L·ªói: ' + error.message, 'danger');
          } else {
            alert('L·ªói: ' + error.message);
          }
        } finally {
          // Re-enable button
          submitBtn.disabled = false;
          submitSpinner.classList.add('d-none');
          submitText.textContent = 'G·ª≠i y√™u c·∫ßu h·ªó tr·ª£';
        }
      });
    </script>
  </body>
</html>

